<html>
	<head>
		<title>Asobi.</title>
		<style type="text/css">
		    #mycanvas {
			position: relative;
                padding-left:0;
                padding-right: 0;
                margin-left: auto;
                margin-right: auto;
				margin-top: 50px;
                display: block;
                border-style: solid;
                border-width: 5px;
                border-color: rgb(0,0,0);
				}
		</style>
	</head>
		<script src="http://cloud.github.com/downloads/processing-js/processing-js/processing-1.4.1.min.js"></script>
		<script type="text/processing" data-processing-target="mycanvas">
			//no click
			/* @pjs globalKeyEvents="true"; */
			
			//establishing some variables
			var girl;
			var stage = 0;
			//movement key variables
			var leftKey = false;
			var upKey = false;
			var rightKey = false;
			var downKey = false;
			
			var jumpState = 0;
			var jumpY;
			var direction = "right";
			
			//stuff that's only run once
			void setup(){
				//size and background
				size(1000,600);
				background(249, 221, 249);
				
				//images
				playerR = loadImage("img/test2.png");
				playerL = loadImage("img/test2l.png");
				stageOne = loadImage("img/testBackground1.png");
			
				girl = new Girl (180,180,10,500);
			}
			
			//important stuff
			void draw(){
				stageChange();
				girl.jump();
				background(249, 221, 249);
				if (stage==1) {
					image(stageOne,0,0);
				}
				
				girl.drawGirl();
				if (leftKey != false) {
					girl.moveLeft();
				}
				if (upKey != false) {
					girl.moveUp();
				}
				if (rightKey != false) {
					girl.moveRight();
				}
				if (downKey != false) {
					girl.moveDown();
				}
			}
			
			//what happens when you press a key?
			void keyPressed(){		
				if (keyCode == 65) {
					direction = "left";
					leftKey = true;
					rightKey = false;
				}
				if (keyCode == 68) {
					direction = "right";
					rightKey = true;
					leftKey = false;
				}
				if (keyCode == 87 && jumpState == 0) {
					direction = "up";
					upKey = true;
					downKey = false;
				}
				if (keyCode == 83 && jumpState == 0) {
					direction = "down";
					downKey = true;
					upKey = false;
				}
				
				if (keyCode == 32) {
					if (jumpState == 0){
						downKey = false;
						jumpY = girl.yPosition;
						jumpState=1;
					}
				}
			}
			
			//what happens when you release a key?
			void keyReleased(){
				if (keyCode == 65) {
					leftKey = false;
				}
				if (keyCode == 68) {
					rightKey = false;
				}
				if (keyCode == 87) {
					upKey = false;
				}
				if (keyCode == 83) {
					downKey = false;
				}
			}
			
			class Girl {
			var xPosition;
			var yPosition;
			var width;
			var height;
				
				Girl(w, h, x, y){
					xPosition = x;
					yPosition = y;
					width = w;
					height = h;
				}
					
				void drawGirl() {
					if (direction == "right") {
						image(playerR,xPosition,yPosition);
					}
					if (direction == "left") {
						image(playerL,xPosition,yPosition);
					}
					if (direction == "up") {
						image(playerR,xPosition,yPosition);
					}
					if (direction == "down") {
						image(playerR,xPosition,yPosition);
					}
				}
				
				void jump() {
					if (jumpState == 1 && yPosition >= jumpY - 100 && frameCount%2 == 0){
						yPosition-=20;
					}
					else if (jumpState == 1 && yPosition < jumpY - 100) {
						jumpState = 2;
					}
					if (jumpState==2 && yPosition < jumpY && frameCount%2 == 0){
						yPosition+=20;
					}
					else if (jumpState == 2 && yPosition == jumpY && jumpState == 2) {
						jumpState = 0;
					}
				}
				
				void moveLeft() {
					xPosition = xPosition - 2;
				}
				void moveRight() {
					xPosition = xPosition + 2;
				}
				void moveUp() {
					yPosition = yPosition - 2;
				}
				void moveDown() {
					yPosition = yPosition + 2;
				}
			}
			
			function stageChange() {
				if (girl.xPosition>=946) {
					stage++;
					girl.xPosition=10;
				}
				if (girl.xPosition<=-10) {
					stage=stage-1;
					girl.xPosition=936;
				}
			}
			
		</script>
	<body>
		<canvas id="mycanvas"></canvas>
	</body>
</html>